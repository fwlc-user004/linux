<section data-intro class="bg-slate-900/20">
  <h2>مقدمه</h2>
  <p>
    اکنون که می‌دانیم چگونه کاربران و گروه‌ها را در سیستم ایجاد کنیم، به
    مهم‌ترین سؤال در مدیریت سیستم می‌رسیم: چگونه کنترل کنیم که این کاربران و
    گروه‌ها به چه فایل‌ها و دایرکتوری‌هایی دسترسی داشته باشند و چه کارهایی
    بتوانند با آن‌ها انجام دهند؟ پاسخ این سؤال در سیستم مجوزها (Permissions)
    لینوکس نهفته است.
  </p>
  <p>
    هر فایل و دایرکتوری در لینوکس دارای مجموعه‌ای از مجوزهاست که به طور دقیق
    مشخص می‌کند چه کسی می‌تواند آن را بخواند، در آن بنویسد یا آن را اجرا کند.
    این سیستم مجوزها، ستون فقرات مدل امنیتی لینوکس است. در این درس، یاد می‌گیریم
    که چگونه این مجوزها را بخوانیم، تفسیر کنیم و با استفاده از دستورات کلیدی
    chmod و chown آن‌ها را مدیریت نماییم.
  </p>
</section>
<section>
  <h2>درک رشته‌ی مجوزها</h2>
  <p>
    همانطور که قبلاً در خروجی دستور ls -l دیده‌ایم، هر خط با یک رشته‌ی ۱۰
    کاراکتری شروع می‌شود. این رشته، تمام اطلاعات مربوط به نوع فایل و مجوزهای آن
    را در خود جای داده است.
  </p>
  <pre dir="ltr" data-cm-lang="bash">
-rwxr-xr-- 1 me developers 150 Jul 22 10:40 script.sh
</pre
  >
  <p>بیایید این رشته (-rwxr-xr--) را کالبدشکافی کنیم:</p>
  <ul class="list-disc pr-6">
    <li>
      کاراکتر اول: نوع فایل. یک خط تیره (-) به معنای فایل عادی، d به معنای
      دایرکتوری و l به معنای لینک نمادین (symbolic link) است.
    </li>
    <li>
      سه کاراکتر بعدی (rwx): مجوزهای مالک فایل (User). در این مثال، کاربر me
      مجوز خواندن، نوشتن و اجرا را دارد.
    </li>
    <li>
      سه کاراکتر وسط (r-x): مجوزهای گروه مالک (Group). در این مثال، اعضای گروه
      developers مجوز خواندن و اجرا را دارند، اما مجوز نوشتن (w) را ندارند (با
      خط تیره نمایش داده شده).
    </li>
    <li>
      سه کاراکتر آخر (r--): مجوزهای دیگران (Others). تمام کاربران دیگر فقط مجوز
      خواندن را دارند.
    </li>
  </ul>

  <h3>معنی خواندن، نوشتن و اجرا (r, w, x)</h3>
  <p>
    معنی این سه مجوز برای فایل‌ها و دایرکتوری‌ها متفاوت است و درک این تفاوت
    بسیار کلیدی است.
  </p>
  <table>
    <thead>
      <tr>
        <th>مجوز</th>
        <th>برای یک فایل</th>
        <th>برای یک دایرکتوری</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>r (Read)</td>
        <td>می‌توان محتوای فایل را خواند (مثلاً با cat).</td>
        <td>می‌توان لیست محتویات دایرکتوری را دید (مثلاً با ls).</td>
      </tr>
      <tr>
        <td>w (Write)</td>
        <td>می‌توان محتوای فایل را تغییر داد یا آن را حذف کرد.</td>
        <td>
          می‌توان در دایرکتوری فایل جدید ساخت، حذف کرد یا نام فایل‌ها را تغییر
          داد.
        </td>
      </tr>
      <tr>
        <td>x (Execute)</td>
        <td>می‌توان فایل را به عنوان یک برنامه یا اسکریپت اجرا کرد.</td>
        <td>می‌توان وارد دایرکتوری شد (مثلاً با cd).</td>
      </tr>
    </tbody>
  </table>
</section>
<section>
  <h2>تغییر مجوزها با chmod</h2>
  <p>
    دستور chmod (مخفف change mode) برای تغییر مجوزهای دسترسی یک فایل یا
    دایرکتوری استفاده می‌شود. دو روش اصلی برای استفاده از این دستور وجود دارد:
    روش نمادین و روش عددی.
  </p>

  <h3>روش نمادین (Symbolic Mode)</h3>
  <p>
    این روش خواناتر و برای شروع ساده‌تر است. ساختار کلی آن به شکل chmod
    who[+,-,=]permission است.
  </p>
  <ul class="list-disc pr-6">
    <li><b>Who (چه کسی):</b> u (کاربر مالک)، g (گروه)، o (دیگران)، a (همه).</li>
    <li>
      <b>Operator (عملگر):</b> + (افزودن مجوز)، - (حذف مجوز)، = (تخصیص دقیق
      مجوز).
    </li>
    <li><b>Permission (مجوز):</b> r، w، x.</li>
  </ul>
  <p>چند مثال:</p>
  <pre dir="ltr" data-cm-lang="bash">
# به گروه، مجوز نوشتن روی فایل را بده
$ chmod g+w shared_file.txt

# از دیگران، مجوز خواندن را بگیر
$ chmod o-r secret_file.txt

# به کاربر مالک و گروه، مجوز اجرا برای اسکریپت را بده
$ chmod ug+x my_script.sh
</pre
  >

  <h3>روش عددی (Octal Mode)</h3>
  <p>
    این روش سریع‌تر است و به طور گسترده توسط مدیران سیستم استفاده می‌شود. در این
    روش، هر مجوز یک مقدار عددی دارد:
  </p>
  <ul class="list-disc pr-6">
    <li>r (خواندن) = 4</li>
    <li>w (نوشتن) = 2</li>
    <li>x (اجرا) = 1</li>
  </ul>
  <p>
    برای هر دسته (کاربر، گروه، دیگران)، اعداد مجوزهای مورد نظر را با هم جمع
    می‌کنیم. برای مثال، مجوز rwx برابر است با 4+2+1=7 و مجوز r-x برابر است با
    4+1=5. سپس سه عدد به دست آمده را کنار هم قرار می‌دهیم.
  </p>

  <h2>تغییر مجوزها با chmod (ادامه)</h2>
  <table>
    <thead>
      <tr>
        <th>عدد</th>
        <th>مجوز</th>
        <th>توضیح</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>7 (4+2+1)</td>
        <td>rwx</td>
        <td>خواندن، نوشتن و اجرا</td>
      </tr>
      <tr>
        <td>6 (4+2)</td>
        <td>rw-</td>
        <td>خواندن و نوشتن</td>
      </tr>
      <tr>
        <td>5 (4+1)</td>
        <td>r-x</td>
        <td>خواندن و اجرا</td>
      </tr>
      <tr>
        <td>4 (4)</td>
        <td>r--</td>
        <td>فقط خواندن</td>
      </tr>
    </tbody>
  </table>

  <p>چند مثال از مجوزهای رایج:</p>
  <pre dir="ltr" data-cm-lang="bash">
# rwxr-xr-x: مجوزی استاندارد برای فایل‌های اجرایی و دایرکتوری‌ها
$ chmod 755 my_script.sh

# rw-r--r--: مجوزی استاندارد برای فایل‌های متنی عادی
$ chmod 644 document.txt

# rw-rw----: مجوزی مناسب برای یک فایل اشتراکی بین اعضای یک گروه
$ chmod 660 collaborative_file.txt
</pre
  >
</section>
<section>
  <h2>تغییر مالکیت با chown</h2>
  <p>
    گاهی اوقات لازم است مالکیت یک فایل را به کاربر یا گروه دیگری منتقل کنیم. این
    کار با دستور chown (مخفف change owner) و با دسترسی sudo انجام می‌شود.
  </p>
  <p>ساختار کلی این دستور به شکل chown user:group filename است.</p>
  <pre dir="ltr" data-cm-lang="bash">
# تغییر مالک فایل به کاربر علی
$ sudo chown ali somefile.txt

# تغییر مالکیت کاربر و گروه فایل به صورت همزمان
$ sudo chown ali:developers project_plan.txt

# تغییر مالکیت یک دایرکتوری و تمام محتویات آن به صورت بازگشتی
$ sudo chown -R ali:developers /srv/project_data
</pre
  >
  <p>
    برای تغییر فقط گروه یک فایل، می‌توان از دستور chgrp نیز استفاده کرد (chgrp
    developers a_file.txt).
  </p>
</section>
