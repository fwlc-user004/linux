<section data-intro class="bg-slate-900/20">
  <h2>مقدمه</h2>
  <p>
    در درس‌های گذشته با ماهیت دستورات و چگونگی دسترسی به مستندات آن‌ها آشنا شدیم. یکی از زیباترین
    ویژگی‌های شل لینوکس این است که شما به استفاده از دستورات موجود محدود نیستید. شما می‌توانید
    ابزارهای خودتان را بسازید، دستورات طولانی را کوتاه کنید و وظایف تکراری را به یک کامند ساده تبدیل
    نمایید. این کار نه تنها باعث صرفه‌جویی در وقت می‌شود، بلکه به شما حس تسلط بیشتری بر محیط
    کاری‌تان می‌دهد.
  </p>
  <p>
    در این درس، دو روش اصلی و بسیار پرکاربرد برای ساخت دستورات سفارشی را بررسی خواهیم کرد:
  </p>
  <ul class="list-disc pr-6">
    <li><b>نام‌های مستعار (Aliases)</b>: برای ساخت میان‌بُرهای ساده و جایگزین برای دستورات موجود.</li>
    <li><b>اسکریپت‌های شل (Shell Scripts)</b>: برای ساخت کامندهای پیچیده‌تر که شامل چندین مرحله یا
      منطق خاصی هستند.</li>
  </ul>
  <p>
    با یادگیری این دو تکنیک، شما قادر خواهید بود تا خط فرمان را مطابق با نیازهای خود شخصی‌سازی کنید
    و بهره‌وری خود را به شکل چشمگیری افزایش دهید.
  </p>
</section>
<section>
  <h2>نگاهی عمیق‌تر به نام‌های مستعار (Alias)</h2>
  <p>
    همانطور که در درس «ماهیت کامندهای لینوکسی» دیدیم، alias یک نام مستعار یا جایگزین برای یک دستور
    دیگر است. این ساده‌ترین راه برای ساخت یک کامند سفارشی است. برای مثال، به جای تایپ کردن ls
    -alh برای دیدن لیست فایل‌ها با جزئیات کامل، می‌توانیم یک alias به نام ll
    برای آن بسازیم.
  </p>
  <pre dir="ltr" data-cm-lang="bash">
$ alias ll='ls -alh'
</pre>

  <h3>دائمی کردن Aliasها</h3>
  <p>
    مشکلی که وجود دارد این است که aliasهایی که مستقیماً در ترمینال تعریف می‌کنیم، موقتی هستند و با
    بستن پنجره ترمینال از بین می‌روند. برای اینکه aliasهای ما دائمی باشند، باید آن‌ها را در فایل‌های
    پیکربندی شل ذخیره کنیم. برای شل bash که رایج‌ترین شل در لینوکس است، این فایل معمولاً
    <bdi>~/.bashrc</bdi> نام دارد. این فایل یک اسکریپت است که هر بار یک ترمینال جدید باز می‌کنید، به
    صورت خودکار اجرا می‌شود.
  </p>
  <p>مراحل دائمی کردن یک alias به صورت زیر است:</p>
  <ol data-steps>
    <li>
      فایل <bdi>~/.bashrc</bdi> را با یک ویرایشگر متن باز کنید. ویرایشگر nano یک
      گزینه‌ی ساده و مناسب برای شروع است: <br><bdi>nano ~/.bashrc</bdi>
    </li>
    <li>
      به انتهای فایل بروید و تعریف alias خود را در یک خط جدید اضافه کنید. برای مثال: <br>
      <bdi>alias ll='ls -alh'</bdi> <br>
      <bdi>alias update='sudo apt update &amp;&amp; sudo apt upgrade'</bdi>
    </li>
    <li>
      فایل را ذخیره کرده و از ویرایشگر خارج شوید (در nano با فشردن <kbd>Ctrl+X</kbd>،
      سپس Y و در نهایت Enter).
    </li>
    <li>
      برای اعمال تغییرات در نشست فعلی ترمینال، دستور source را اجرا کنید: <br>
      <bdi>source ~/.bashrc</bdi>
    </li>
  </ol>
  <p>
    پس از این، alias شما در تمام ترمینال‌های جدیدی که باز می‌کنید در دسترس خواهد بود.
  </p>

  <h3>حذف کردن Aliasها</h3>
  <p>
    برای حذف یک alias از نشست فعلی، می‌توانید از دستور unalias استفاده کنید.
  </p>
  <pre dir="ltr" data-cm-lang="bash">
$ unalias ll
</pre>
  <p>
    برای حذف دائمی آن، کافی است خط مربوطه را از فایل <bdi>~/.bashrc</bdi> پاک کنید.
  </p>
</section>
<section>
  <h2>ساخت کامند با اسکریپت‌های شل</h2>
  <p>
    گاهی اوقات یک alias برای کار ما کافی نیست. ممکن است بخواهیم چندین دستور را پشت سر هم اجرا کنیم
    یا منطق پیچیده‌تری را پیاده‌سازی کنیم. در این موارد، به سراغ اسکریپت‌های شل می‌رویم. یک اسکریپت
    شل، چیزی نیست جز یک فایل متنی ساده که حاوی یک یا چند دستور لینوکس است.
  </p>

  <h3>اولین اسکریپت: کامند «بکاپ‌بگیر»</h3>
  <p>
    بیایید یک کامند سفارشی به نام backup بسازیم که از یک دایرکتوری مشخص یک نسخه‌ی پشتیبان
    فشرده تهیه می‌کند.
  </p>

  <ol data-steps>
    <li>
      <b>ساخت فایل اسکریپت:</b> با ویرایشگر nano یک فایل به نام backup.sh
      ایجاد کنید: <br><bdi>nano backup.sh</bdi>
    </li>
    <li>
      <b>افزودن محتوا:</b> محتوای زیر را در فایل کپی کنید.
      <pre dir="ltr" data-cm-lang="bash">
#!/bin/bash
# A simple script to backup a directory
tar -czvf my_backup_$(date +%Y-%m-%d).tar.gz /home/me/Documents
</pre>
      خط اول که با <bdi>#!</bdi> شروع می‌شود، <b>Shebang</b> نام دارد و به سیستم می‌گوید که این
      اسکریپت باید با مفسر <bdi>/bin/bash</bdi> اجرا شود. خط دوم یک کامنت است و خط سوم دستور اصلی
      ماست که با استفاده از tar یک فایل فشرده با تاریخ روز از دایرکتوری
      Documents می‌سازد.
    </li>
    <li>
      <b>قابل اجرا کردن اسکریپت:</b> به طور پیش‌فرض، فایل‌های متنی جدید اجازه‌ی اجرا ندارند. باید
      با استفاده از دستور chmod این مجوز را به آن اضافه کنیم.
      <pre dir="ltr" data-cm-lang="bash">
$ chmod +x backup.sh
</pre>
    </li>
    <li>
      <b>اجرای اسکریپت:</b> حالا می‌توانید اسکریپت را از همان دایرکتوری با دستور زیر اجرا کنید.
      علامت <bdi>./</bdi> به شل می‌گوید که فایل اجرایی در همین دایرکتوری فعلی قرار دارد.
      <pre dir="ltr" data-cm-lang="bash">
$ ./backup.sh
</pre>
    </li>
  </ol>
</section>
<section>
  <h2>قرار دادن اسکریپت در مسیر <bdi>$PATH</bdi></h2>
  <p>
    اجرای اسکریپت با <bdi>./backup.sh</bdi> خوب است، اما ما می‌خواهیم مانند یک دستور واقعی، بتوانیم
    آن را از هر مسیری فقط با تایپ کردن نامش (مثلاً backup) اجرا کنیم. برای این کار، باید
    فایل اسکریپت خود را در یکی از دایرکتوری‌هایی قرار دهیم که در متغیر محیطی <bdi>$PATH</bdi> لیست
    شده‌اند.
  </p>
  <p>
    بهترین روش برای اسکریپت‌های شخصی، ایجاد یک دایرکتوری bin در پوشه‌ی home خودمان است.
    بسیاری از توزیع‌های لینوکس به صورت خودکار این دایرکتوری را در صورت وجود به <bdi>$PATH</bdi>
    اضافه می‌کنند.
  </p>
  <ol data-steps>
    <li>
      یک دایرکتوری به نام <bdi>~/.local/bin</bdi> در پوشه‌ی home خود بسازید (این مسیر استاندارد
      جدیدتری است):
      <pre dir="ltr" data-cm-lang="bash">
$ mkdir -p ~/.local/bin
</pre>
    </li>
    <li>
      اسکریپت خود را به آنجا منتقل کرده و نام آن را ساده‌سازی کنید:
      <pre dir="ltr" data-cm-lang="bash">
$ mv backup.sh ~/.local/bin/backup
</pre>
    </li>
    <li>
      ترمینال خود را ببندید و دوباره باز کنید. حالا سیستم باید کامند جدید شما را بشناسد. می‌توانید
      با دستور type این موضوع را بررسی کنید:
      <pre dir="ltr" data-cm-lang="bash">
$ type backup
backup is /home/me/.local/bin/backup
</pre>
    </li>
  </ol>
  <p>
    تبریک! شما با موفقیت یک کامند سفارشی کاملاً کاربردی ساختید که از هر کجای سیستم قابل اجراست.
  </p>
</section>
